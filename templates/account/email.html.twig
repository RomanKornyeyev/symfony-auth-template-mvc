{% extends 'base.html.twig' %}
{% block title %}Cambiar email
{% endblock %}

{% block content %}
	<div class="d-flex justify-content-center align-items-center h-100">
		<div class="form-wrapper">
			<h1 class="text-center mb-3">Cambiar email</h1>
			<p class="text-center mb-3">
        {% if app.user.pendingEmail %}
          Actualmente tienes un cambio de email pendiente.
        {% else %}
          Se enviará un email de confirmación.
        {% endif %}
      </p>

			{% if app.user.pendingEmail %}
				<div class="alert alert-info" role="alert">
					<strong>Email pendiente:</strong>
					{{ app.user.pendingEmail }}<br>
					<span class="small text-muted">Confirma desde tu correo actual, o reenvía/cancela.</span>
          {{ include('account/partials/_pending_email_timeline.html.twig') }}
				</div>

				<div class="d-flex gap-2">
					<form method="post" action="{{ path('app_account_email_resend') }}">
						<input type="hidden" name="_token" value="{{ csrf_token('account_email_resend') }}">
						<button class="btn btn-outline-primary" type="submit">Reenviar confirmación</button>
					</form>

					<form method="post" action="{{ path('app_account_email_cancel') }}">
						<input type="hidden" name="_token" value="{{ csrf_token('account_email_cancel') }}">
						<button class="btn btn-outline-danger" type="submit">Cancelar cambio</button>
					</form>
				</div>

        <div class="mt-5 text-center">
          
          <a href="{{ path('app_account_index') }}" class="btn btn-primary"><i class="fa-solid fa-angle-left"></i> Volver a la cuenta</a>
        </div>
			{% else %}
				{{ form_start(form, { 'attr': { 'class': 'p-4 p-md-5 border rounded-3 bg-body-tertiary' } }) }}
          {{ form_row(form.newEmail) }}
          <div class="d-flex gap-2">
              <button type="submit" class="btn btn-primary">Enviar verificación</button>
              <a href="{{ path('app_account_index') }}" class="btn btn-outline-primary">Cancelar</a>
          </div>
				{{ form_end(form) }}
			{% endif %}
		</div>
	</div>
{% endblock %}
